{% extends "layout.html" %}
{% from "bootstrap.html" import colorful_label, table with context %}

{% block title %}Manage Proxies{% endblock %}

{% block content %}
  <script>
      var proxies = [
      {% for proxy in proxies %}
          '<tr data-target="proxy" data-name="{{ proxy.name }}">' +
          '  <td>{{ proxy.id }}</td>' +
          '  <td><div class="badge bg-primary">{{ proxy.name }}</div></td>' +
          '  <td>{{ colorful_label(proxy.type|upper) }}</td>' +
          '  <td>{{ proxy.host }}</td>' +
          '  <td>{{ proxy.port }}</td>' +
          '  <td>{{ proxy.username or '' }}</td>' +
          '  <td>{{ proxy.password or ''}}</td>' +
          '  <td>{{ proxy.last_check}}</td>' +
          '  <td>{{ colorful_label(proxy.online, tooltip=proxy.error) }}</td>' +
          '  <td>{{ (proxy.streams or [])|length }}</td>' +
          '  <td>' +
          '    <a href="{{ url_for('proxy.settings', proxy=proxy) }}" class="btn btn-link">' +
          '      <i class="fa fa-cog" title="settings"></i>' +
          '    </a>' +

          '    <form action="{{ url_for('proxy.delete', proxy=proxy) }}" method="post">' +
          '      <button type="submit" class="btn btn-link"' +
          '              data-toggle="confirmation"' +
          '              data-message="Please confirm to delete the proxy {{ proxy.id }} {{ proxy.url }}?">' +
          '        <i class="fa fa-times text-danger" title="delete"></i>' +
          '      </button>' +
          '    </form>' +
          '  </td>' +
          '</tr>'{% if not loop.last %},{% endif %}
      {% endfor %}
      ];
  </script>
  {% call table(columns=['ID', 'Name', 'Type', 'Host', 'Port', 'Username', 'Password',
                         'Last Check', 'Status', 'Streams', 'Settings'], data='proxies') %}
  {% endcall %}
{% endblock %}
